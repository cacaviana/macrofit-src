import{e as t}from"./environment.d04864f2.js";const c=[{id:"meal-1",userId:"user-1",mealType:"breakfast",timestamp:"2024-10-06T08:15:00Z",source:"text",description:"Aveia com banana e mel",foods:[{id:"food-1",name:"Aveia em flocos",quantity:50,unit:"g",calories:190,protein:6.9,carbs:32.8,fat:3.4},{id:"food-2",name:"Banana nanica",quantity:120,unit:"g",calories:105,protein:1.3,carbs:26.9,fat:.4},{id:"food-3",name:"Mel",quantity:20,unit:"g",calories:65,protein:.1,carbs:17.3,fat:0}],totalCalories:360,totalProtein:8.3,totalCarbs:77,totalFat:3.8},{id:"meal-2",userId:"user-1",mealType:"lunch",timestamp:"2024-10-06T12:30:00Z",source:"photo",description:"Peito de frango grelhado com arroz integral",foods:[{id:"food-4",name:"Peito de frango grelhado",quantity:150,unit:"g",calories:248,protein:31,carbs:0,fat:12.8},{id:"food-5",name:"Arroz integral cozido",quantity:100,unit:"g",calories:130,protein:3,carbs:28,fat:1},{id:"food-6",name:"Br√≥colis refogado",quantity:80,unit:"g",calories:22,protein:2.4,carbs:4,fat:.3}],totalCalories:400,totalProtein:36.4,totalCarbs:32,totalFat:14.1},{id:"meal-3",userId:"user-1",mealType:"snack",timestamp:"2024-10-06T15:45:00Z",source:"text",description:"Iogurte grego com granola",foods:[{id:"food-7",name:"Iogurte grego natural",quantity:200,unit:"ml",calories:200,protein:18,carbs:12,fat:10},{id:"food-8",name:"Granola",quantity:30,unit:"g",calories:150,protein:4.5,carbs:18,fat:6}],totalCalories:350,totalProtein:22.5,totalCarbs:30,totalFat:16},{id:"meal-4",userId:"user-1",mealType:"dinner",timestamp:"2024-10-06T19:20:00Z",source:"audio",description:"Salm√£o grelhado com batata doce",foods:[{id:"food-9",name:"Salm√£o grelhado",quantity:100,unit:"g",calories:208,protein:25.4,carbs:0,fat:12.4},{id:"food-10",name:"Batata doce assada",quantity:100,unit:"g",calories:103,protein:2.3,carbs:24.3,fat:.1},{id:"food-11",name:"Aspargos",quantity:80,unit:"g",calories:16,protein:1.8,carbs:3.2,fat:.1}],totalCalories:327,totalProtein:29.5,totalCarbs:27.5,totalFat:12.6}],d=[{id:"food-db-1",name:"Banana nanica",calories:87,protein:1.1,carbs:22.8,fat:.3,unit:"100g"},{id:"food-db-2",name:"Peito de frango grelhado",calories:165,protein:31,carbs:0,fat:3.6,unit:"100g"},{id:"food-db-3",name:"Arroz integral cozido",calories:130,protein:3,carbs:28,fat:1,unit:"100g"},{id:"food-db-4",name:"Aveia em flocos",calories:380,protein:13.8,carbs:65.6,fat:6.8,unit:"100g"},{id:"food-db-5",name:"Iogurte grego natural",calories:100,protein:9,carbs:6,fat:5,unit:"100ml"},{id:"food-db-6",name:"Salm√£o grelhado",calories:208,protein:25.4,carbs:0,fat:12.4,unit:"100g"},{id:"food-db-7",name:"Batata doce assada",calories:103,protein:2.3,carbs:24.3,fat:.1,unit:"100g"},{id:"food-db-8",name:"Br√≥colis refogado",calories:28,protein:3,carbs:5,fat:.4,unit:"100g"},{id:"food-db-9",name:"Granola",calories:500,protein:15,carbs:60,fat:20,unit:"100g"},{id:"food-db-10",name:"Mel",calories:325,protein:.5,carbs:86.5,fat:0,unit:"100g"}],u={date:"2024-10-06",totalCalories:1437,totalProtein:96.7,totalCarbs:166.5,totalFat:46.5,goals:{calories:1850,protein:140,carbs:185,fat:62},percentages:{calories:78,protein:69,carbs:90,fat:75},remaining:{calories:413,protein:43.3,carbs:18.5,fat:15.5}};class m{constructor(){this.baseUrl=t.apiUrl,this.useMock=t.useMock,console.log("üçΩÔ∏è MealsRepository: Repository de refei√ß√µes inicializado"),console.log("üçΩÔ∏è MealsRepository: Modo mock:",this.useMock)}async simulateNetworkDelay(){const o=Math.random()*1e3+500;await new Promise(e=>setTimeout(e,o))}async createMealFromText(o){if(this.useMock)return this.mockCreateMealFromText(o);const e=await fetch(`${this.baseUrl}/meals/text`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o.toPayload())});if(!e.ok)throw new Error(`Erro ao criar refei√ß√£o: ${e.status}`);return e.json()}async mockCreateMealFromText(o){await this.simulateNetworkDelay();const e=o.toPayload();return{success:!0,meal:{id:"meal-"+Date.now(),userId:e.userId,mealType:e.mealType,timestamp:e.timestamp,source:e.source,description:e.description,foods:[{id:"food-analyzed-1",name:"Alimento identificado pela IA",quantity:100,unit:"g",calories:150,protein:8,carbs:20,fat:5}],totalCalories:150,totalProtein:8,totalCarbs:20,totalFat:5,aiAnalysis:{confidence:.85,suggestions:["Adicione mais prote√≠na","Considere incluir vegetais"]}},message:"Refei√ß√£o registrada e analisada com sucesso"}}async createMealFromPhoto(o){if(this.useMock)return this.mockCreateMealFromPhoto(o);const e=new FormData;e.append("image",o.imageFile),e.append("mealType",o.mealType),e.append("timestamp",o.timestamp),e.append("description",o.description);const a=await fetch(`${this.baseUrl}/meals/photo`,{method:"POST",body:e});if(!a.ok)throw new Error(`Erro ao criar refei√ß√£o: ${a.status}`);return a.json()}async mockCreateMealFromPhoto(o){await this.simulateNetworkDelay();const e=o.toPayload();return{success:!0,meal:{id:"meal-"+Date.now(),userId:e.userId,mealType:e.mealType,timestamp:e.timestamp,source:e.source,description:e.description||"Prato identificado pela IA",foods:[{id:"food-photo-1",name:"Frango grelhado",quantity:120,unit:"g",calories:198,protein:37.2,carbs:0,fat:4.3},{id:"food-photo-2",name:"Arroz branco",quantity:80,unit:"g",calories:104,protein:2.4,carbs:22.4,fat:.8}],totalCalories:302,totalProtein:39.6,totalCarbs:22.4,totalFat:5.1,aiAnalysis:{confidence:.92,recognizedItems:["Frango grelhado","Arroz branco"],suggestions:["Excelente fonte de prote√≠na!"]}},message:"Foto analisada e refei√ß√£o registrada com sucesso"}}async createMealFromAudio(o){if(this.useMock)return this.mockCreateMealFromAudio(o);const e=new FormData;e.append("audio",o.audioBlob),e.append("mealType",o.mealType),e.append("timestamp",o.timestamp);const a=await fetch(`${this.baseUrl}/meals/audio`,{method:"POST",body:e});if(!a.ok)throw new Error(`Erro ao criar refei√ß√£o: ${a.status}`);return a.json()}async mockCreateMealFromAudio(o){await this.simulateNetworkDelay();const e=o.toPayload();return{success:!0,meal:{id:"meal-"+Date.now(),userId:e.userId,mealType:e.mealType,timestamp:e.timestamp,source:e.source,description:"Salada de atum com tomate e cebola",transcription:"Comi uma salada de atum com tomate e cebola",foods:[{id:"food-audio-1",name:"Atum em conserva",quantity:100,unit:"g",calories:116,protein:25.5,carbs:0,fat:.8},{id:"food-audio-2",name:"Tomate",quantity:80,unit:"g",calories:14,protein:.7,carbs:3,fat:.2}],totalCalories:130,totalProtein:26.2,totalCarbs:3,totalFat:1,aiAnalysis:{confidence:.88,transcriptionAccuracy:.95,suggestions:["√ìtima escolha de prote√≠na magra!"]}},message:"√Åudio transcrito e refei√ß√£o registrada com sucesso"}}async searchFood(o){if(this.useMock)return this.mockSearchFood(o);const e=new URLSearchParams(o.toPayload()),a=await fetch(`${this.baseUrl}/foods/search?${e}`);if(!a.ok)throw new Error(`Erro na busca: ${a.status}`);return a.json()}async mockSearchFood(o){await this.simulateNetworkDelay();const e=o.toPayload(),a=e.query.toLowerCase(),r=d.filter(l=>l.name.toLowerCase().includes(a)),s=e.offset,i=s+e.limit;return{success:!0,foods:r.slice(s,i),total:r.length,offset:e.offset,limit:e.limit,hasMore:i<r.length}}async getMealsHistory(o=null){if(this.useMock)return this.mockGetMealsHistory(o);const e=o?`?date=${o}`:"",a=await fetch(`${this.baseUrl}/meals/history${e}`);if(!a.ok)throw new Error(`Erro ao obter hist√≥rico: ${a.status}`);return a.json()}async mockGetMealsHistory(o=null){await this.simulateNetworkDelay();const e=o||new Date().toISOString().split("T")[0],a=c.filter(r=>r.timestamp.startsWith(e));return{success:!0,meals:a,date:e,totalMeals:a.length}}async getDailyNutritionSummary(o=null){if(this.useMock)return this.mockGetDailyNutritionSummary(o);const e=o?`?date=${o}`:"",a=await fetch(`${this.baseUrl}/meals/nutrition/daily${e}`);if(!a.ok)throw new Error(`Erro ao obter resumo: ${a.status}`);return a.json()}async mockGetDailyNutritionSummary(o=null){await this.simulateNetworkDelay();const e=o||new Date().toISOString().split("T")[0];return{success:!0,nutrition:{...u,date:e}}}async deleteMeal(o){if(this.useMock)return this.mockDeleteMeal(o);const e=await fetch(`${this.baseUrl}/meals/${o}`,{method:"DELETE"});if(!e.ok)throw new Error(`Erro ao deletar refei√ß√£o: ${e.status}`);return e.json()}async mockDeleteMeal(o){return await this.simulateNetworkDelay(),{success:!0,message:"Refei√ß√£o deletada com sucesso",deletedMealId:o}}}const f=new m;class y{constructor(){this.repository=f,console.log("üçΩÔ∏è MealsService: Servi√ßo de refei√ß√µes inicializado")}async createMealFromText(o){if(!o.isValid())throw new Error("Dados da refei√ß√£o inv√°lidos");try{t.enableLogs&&console.log("üçΩÔ∏è MealsService: Registrando refei√ß√£o via texto...");const e=await this.repository.createMealFromText(o);return t.enableLogs&&console.log("‚úÖ MealsService: Refei√ß√£o registrada com sucesso"),e}catch(e){throw console.error("‚ùå MealsService: Erro ao registrar refei√ß√£o:",e),e}}async createMealFromPhoto(o){if(!o.isValid())throw new Error("Dados da refei√ß√£o inv√°lidos");try{t.enableLogs&&console.log("üçΩÔ∏è MealsService: Registrando refei√ß√£o via foto...");const e=await this.repository.createMealFromPhoto(o);return t.enableLogs&&console.log("‚úÖ MealsService: Refei√ß√£o registrada com sucesso"),e}catch(e){throw console.error("‚ùå MealsService: Erro ao registrar refei√ß√£o:",e),e}}async createMealFromAudio(o){if(!o.isValid())throw new Error("Dados da refei√ß√£o inv√°lidos");try{t.enableLogs&&console.log("üçΩÔ∏è MealsService: Registrando refei√ß√£o via √°udio...");const e=await this.repository.createMealFromAudio(o);return t.enableLogs&&console.log("‚úÖ MealsService: Refei√ß√£o registrada com sucesso"),e}catch(e){throw console.error("‚ùå MealsService: Erro ao registrar refei√ß√£o:",e),e}}async searchFood(o){if(!o.isValid())throw new Error("Par√¢metros de busca inv√°lidos");try{t.enableLogs&&console.log("üçΩÔ∏è MealsService: Buscando alimentos...");const e=await this.repository.searchFood(o);return t.enableLogs&&console.log("‚úÖ MealsService: Busca realizada com sucesso"),e}catch(e){throw console.error("‚ùå MealsService: Erro na busca de alimentos:",e),e}}async getMealsHistory(o=null){try{t.enableLogs&&console.log("üçΩÔ∏è MealsService: Obtendo hist√≥rico de refei√ß√µes...");const e=await this.repository.getMealsHistory(o);return t.enableLogs&&console.log("‚úÖ MealsService: Hist√≥rico obtido com sucesso"),e}catch(e){throw console.error("‚ùå MealsService: Erro ao obter hist√≥rico:",e),e}}async getDailyNutritionSummary(o=null){try{t.enableLogs&&console.log("üçΩÔ∏è MealsService: Obtendo resumo nutricional...");const e=await this.repository.getDailyNutritionSummary(o);return t.enableLogs&&console.log("‚úÖ MealsService: Resumo obtido com sucesso"),e}catch(e){throw console.error("‚ùå MealsService: Erro ao obter resumo nutricional:",e),e}}async deleteMeal(o){if(!o)throw new Error("ID da refei√ß√£o √© obrigat√≥rio");try{t.enableLogs&&console.log("üçΩÔ∏è MealsService: Deletando refei√ß√£o...");const e=await this.repository.deleteMeal(o);return t.enableLogs&&console.log("‚úÖ MealsService: Refei√ß√£o deletada com sucesso"),e}catch(e){throw console.error("‚ùå MealsService: Erro ao deletar refei√ß√£o:",e),e}}}export{y as M};

import{o as l}from"./scheduler.322242fb.js";import{g as a}from"./navigation.896eb98e.js";import{w as n}from"./singletons.37dba535.js";import{e as i}from"./environment.d04864f2.js";function g(){const s=i.authMode,e=n(s==="dev"),o=n(s!=="dev");l(async()=>{switch(s){case"dev":console.log("🔓 DEV Mode: Acesso liberado para desenvolvimento"),e.set(!0),o.set(!1);break;case"accp":await c();break;case"prod":await r();break;default:console.warn("⚠️ AUTH_MODE inválido:",s),e.set(!1),o.set(!1),a("/auth/login")}});async function c(){try{if(!localStorage.getItem("macrofit_access_token")){console.log("🔒 ACCP Mode: Token não encontrado no localStorage"),e.set(!1),o.set(!1),a("/auth/login");return}console.log("✅ ACCP Mode: Autenticado via localStorage"),e.set(!0),o.set(!1)}catch(t){console.error("🔒 ACCP Mode: Erro na verificação -",t),e.set(!1),o.set(!1),a("/auth/login")}}async function r(){try{const t=await fetch("/api/auth/verify",{method:"GET",credentials:"include",headers:{Accept:"application/json"}});if(!t.ok){console.log("🔒 PROD Mode: Verificação falhou -",t.status),e.set(!1),o.set(!1),a("/auth/login");return}console.log("✅ PROD Mode: Autenticado via httpOnly cookies"),e.set(!0),o.set(!1)}catch(t){console.log("🔒 PROD Mode: Erro na verificação -",t.message),e.set(!1),o.set(!1),a("/auth/login")}}return{isAuthenticated:e,isChecking:o}}export{g as u};
